(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},3030,27612,e=>{"use strict";let t={food:{label:"Food",icon:"ðŸœ"},drinks:{label:"Drinks",icon:"ðŸº"},transport:{label:"Transport",icon:"ðŸš•"},activities:{label:"Activities",icon:"ðŸŽ¯"},tickets:{label:"Tickets",icon:"ðŸŽ«"},shopping:{label:"Shopping",icon:"ðŸ›ï¸"},flights:{label:"Flights",icon:"âœˆï¸"},accommodation:{label:"Stay",icon:"ðŸ›ï¸"},other:{label:"Other",icon:"ðŸ“¦"}},a=Object.entries(t).map(([e,t])=>({value:e,...t}));e.s(["CATEGORIES",0,t,"CATEGORY_LIST",0,a],3030);let s=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],27612)},93479,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,type:s,...n}){return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}e.s(["Input",()=>s])},48425,e=>{"use strict";var t=e.i(71645),a=e.i(74080),s=e.i(91918),n=e.i(43476),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let i=(0,s.createSlot)(`Primitive.${a}`),r=t.forwardRef((e,t)=>{let{asChild:s,...r}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(s?i:a,{...r,ref:t})});return r.displayName=`Primitive.${a}`,{...e,[a]:r}},{});function r(e,t){e&&a.flushSync(()=>e.dispatchEvent(t))}e.s(["Primitive",()=>i,"dispatchDiscreteCustomEvent",()=>r])},10204,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(48425),n=a.forwardRef((e,a)=>(0,t.jsx)(s.Primitive.label,{...e,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label",e.s(["Label",()=>n,"Root",()=>n],73741);var i=e.i(73741),i=i,r=e.i(75157);function l({className:e,...a}){return(0,t.jsx)(i.Root,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}e.s(["Label",()=>l],10204)},36984,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),n=e.i(46932),i=e.i(41447),r=e.i(19455),l=e.i(93479),o=e.i(10204),d=e.i(97857),c=e.i(75157),u=e.i(43531);let m=[{value:"equal",label:"Equal",desc:"Split evenly"},{value:"exact",label:"Exact",desc:"Enter amounts"},{value:"percentage",label:"%",desc:"By percentage"},{value:"shares",label:"Shares",desc:"By shares"}];function p({members:e,amount:s,splitType:n,onSplitTypeChange:i,splits:r,onSplitsChange:o}){let[p,x]=(0,a.useState)(new Set(e.map(e=>e.id)));function h(e,t){o(r.map(a=>a.memberId===e?{...a,amount:t}:a))}(0,a.useEffect)(()=>{"equal"===n&&o(e.filter(e=>p.has(e.id)).map(e=>({memberId:e.id,amount:0})))},[p,n,e,o]),(0,a.useEffect)(()=>{if("exact"===n){let t=new Map(r.map(e=>[e.memberId,e.amount]));o(e.map(e=>({memberId:e.id,amount:t.get(e.id)??0})))}else if("percentage"===n){let t=new Map(r.map(e=>[e.memberId,e.amount])),a=Math.round(1e4/e.length)/100;o(e.map(e=>({memberId:e.id,amount:t.get(e.id)??a})))}else if("shares"===n){let t=new Map(r.map(e=>[e.memberId,e.amount]));o(e.map(e=>({memberId:e.id,amount:t.get(e.id)??1})))}},[n]);let b="equal"===n&&p.size>0?s/p.size:0,f="exact"===n?r.reduce((e,t)=>e+t.amount,0):0,g="percentage"===n?r.reduce((e,t)=>e+t.amount,0):0,v="shares"===n?r.reduce((e,t)=>e+t.amount,0):0;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex gap-1.5 p-1 bg-muted rounded-xl",children:m.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>i(e.value),className:(0,c.cn)("flex-1 py-2 px-2 rounded-lg text-xs font-medium transition-all",n===e.value?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"),children:e.label},e.value))}),(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>{let a=r.find(t=>t.memberId===e.id),s=p.has(e.id);return(0,t.jsxs)("div",{className:(0,c.cn)("flex items-center gap-3 p-2.5 rounded-xl transition-colors","equal"===n&&"cursor-pointer","equal"===n&&!s&&"opacity-40"),onClick:()=>(function(e){if("equal"!==n)return;let t=new Set(p);t.has(e)?t.size>1&&t.delete(e):t.add(e),x(t)})(e.id),children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(d.MemberAvatar,{name:e.name,color:e.color,size:"md"}),"equal"===n&&s&&(0,t.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 h-4 w-4 rounded-full bg-emerald-500 flex items-center justify-center",children:(0,t.jsx)(u.Check,{className:"h-2.5 w-2.5 text-white"})})]}),(0,t.jsx)("span",{className:"text-sm font-medium flex-1",children:e.name}),"equal"===n&&s&&(0,t.jsx)("span",{className:"text-sm text-muted-foreground tabular-nums",children:b>0?b.toFixed(2):"0.00"}),"exact"===n&&(0,t.jsx)(l.Input,{type:"number",inputMode:"decimal",className:"w-24 text-right h-8 text-sm",value:a?.amount||"",onChange:t=>h(e.id,parseFloat(t.target.value)||0),onClick:e=>e.stopPropagation()}),"percentage"===n&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(l.Input,{type:"number",inputMode:"decimal",className:"w-20 text-right h-8 text-sm",value:a?.amount||"",onChange:t=>h(e.id,parseFloat(t.target.value)||0),onClick:e=>e.stopPropagation()}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"%"})]}),"shares"===n&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",className:"h-7 w-7 rounded-full bg-muted flex items-center justify-center text-sm hover:bg-muted-foreground/20 transition-colors",onClick:t=>{t.stopPropagation(),h(e.id,Math.max(0,(a?.amount??1)-1))},children:"âˆ’"}),(0,t.jsx)("span",{className:"text-sm font-medium w-6 text-center tabular-nums",children:a?.amount??1}),(0,t.jsx)("button",{type:"button",className:"h-7 w-7 rounded-full bg-muted flex items-center justify-center text-sm hover:bg-muted-foreground/20 transition-colors",onClick:t=>{t.stopPropagation(),h(e.id,(a?.amount??1)+1)},children:"+"})]})]},e.id)})}),"exact"===n&&s>0&&(0,t.jsx)("p",{className:(0,c.cn)("text-xs text-center",.01>Math.abs(f-s)?"text-emerald-600":"text-red-500"),children:.01>Math.abs(f-s)?"âœ“ Amounts match":`${f.toFixed(2)} of ${s.toFixed(2)} assigned (${(s-f).toFixed(2)} remaining)`}),"percentage"===n&&(0,t.jsx)("p",{className:(0,c.cn)("text-xs text-center",.01>Math.abs(g-100)?"text-emerald-600":"text-red-500"),children:.01>Math.abs(g-100)?"âœ“ Adds up to 100%":`Total: ${g.toFixed(1)}%`}),"shares"===n&&v>0&&s>0&&(0,t.jsxs)("p",{className:"text-xs text-center text-muted-foreground",children:["Each share = ",(s/v).toFixed(2)]})]})}var x=e.i(3030),h=e.i(85149),b=e.i(71689),f=e.i(27612);function g({params:e}){let{id:u}=(0,a.use)(e),m=(0,s.useSearchParams)().get("edit"),{getTrip:g,addExpense:v,updateExpense:j,deleteExpense:y,updateTrip:N}=(0,i.useStore)(),w=(0,s.useRouter)(),k=g(u),[S,C]=(0,a.useState)(""),[M,I]=(0,a.useState)(""),[E,T]=(0,a.useState)(k?.currency??"SGD"),[L,F]=(0,a.useState)(""),[A,R]=(0,a.useState)(k?.members[0]?.id??""),[P,D]=(0,a.useState)("food"),[q,B]=(0,a.useState)(new Date().toISOString().slice(0,10)),[$,z]=(0,a.useState)("equal"),[O,G]=(0,a.useState)([]),U=(0,a.useCallback)(e=>{G(e)},[]);if((0,a.useEffect)(()=>{if(!k||!m)return;let e=k.expenses.find(e=>e.id===m);e?(C(e.description),I(e.amount.toString()),T(e.currency??k.currency),R(e.paidBy),D(e.category),B(e.date),z(e.splitType),G(e.splits)):w.replace(`/trip/${k.id}`)},[k,m,w]),!k)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-dvh p-4",children:[(0,t.jsx)("p",{className:"text-4xl mb-4",children:"ðŸ”"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Trip not found"}),(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>w.push("/"),children:"Go home"})]});let _=parseFloat(M)||0,H=E!==k.currency,K=k.exchangeRates?.[E]!=null,V=parseFloat(L)||0,Y=K||H&&V>0,W=S.trim().length>0&&_>0&&A&&(!H||Y);return(0,t.jsxs)("div",{className:"px-4 pb-8",children:[(0,t.jsxs)(n.motion.header,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-3 pt-6 pb-4",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"icon",className:"rounded-full shrink-0",onClick:()=>w.back(),children:(0,t.jsx)(b.ArrowLeft,{className:"h-5 w-5"})}),(0,t.jsx)("h1",{className:"text-xl font-bold",children:m?"Edit Expense":"Add Expense"})]}),(0,t.jsxs)(n.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Label,{children:"Currency"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 max-h-32 overflow-y-auto",children:h.CURRENCIES_LIST.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>T(e.code),className:(0,c.cn)("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm transition-all",E===e.code?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted-foreground/10"),children:[(0,t.jsx)("span",{children:e.code}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:["(",e.symbol,")"]})]},e.code))})]}),H&&!K&&(0,t.jsxs)("div",{children:[(0,t.jsxs)(o.Label,{htmlFor:"rate",children:["1 ",E," = ? ",k.currency]}),(0,t.jsx)(l.Input,{id:"rate",type:"number",inputMode:"decimal",placeholder:"e.g. 111",value:L,onChange:e=>F(e.target.value),className:"mt-1.5"})]}),(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)(o.Label,{className:"text-sm text-muted-foreground",children:"Amount"}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2",children:[(0,t.jsx)("span",{className:"text-3xl text-muted-foreground font-light",children:(0,h.getCurrencySymbol)(E)}),(0,t.jsx)("input",{type:"number",inputMode:"decimal",placeholder:"0.00",value:M,onChange:e=>I(e.target.value),className:"text-5xl font-bold bg-transparent border-none outline-none w-48 text-center tabular-nums [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",autoFocus:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Label,{htmlFor:"desc",children:"Description"}),(0,t.jsx)(l.Input,{id:"desc",placeholder:"What was this for?",value:S,onChange:e=>C(e.target.value),className:"mt-1.5"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Label,{htmlFor:"date",children:"Date"}),(0,t.jsx)(l.Input,{id:"date",type:"date",value:q,onChange:e=>B(e.target.value),className:"mt-1.5"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Label,{children:"Category"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:x.CATEGORY_LIST.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>D(e.value),className:(0,c.cn)("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm transition-all",P===e.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted-foreground/10"),children:[(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Label,{children:"Paid by"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:k.members.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>R(e.id),className:(0,c.cn)("flex items-center gap-2 px-3 py-2 rounded-xl transition-all",A===e.id?"bg-primary/10 ring-2 ring-primary":"bg-muted hover:bg-muted-foreground/10"),children:[(0,t.jsx)(d.MemberAvatar,{name:e.name,color:e.color,size:"sm"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.name})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Label,{children:"Split between"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(p,{members:k.members,amount:_,splitType:$,onSplitTypeChange:z,splits:O,onSplitsChange:U})})]}),(0,t.jsx)(r.Button,{className:"w-full",size:"lg",disabled:!W,onClick:function(){if(!S.trim()||_<=0||!A||H&&!Y)return;H&&V>0&&N(k.id,{exchangeRates:{...k.exchangeRates,[E]:V}});let e={description:S.trim(),amount:_,currency:E,paidBy:A,splitType:$,splits:O,category:P,date:q};m?j(k.id,m,e):v(k.id,e),w.push(`/trip/${k.id}`)},children:m?"Save Changes":"Add Expense"}),m&&(0,t.jsxs)(r.Button,{variant:"ghost",className:"w-full text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{confirm("Delete this expense?")&&(y(k.id,m),w.push(`/trip/${k.id}`))},children:[(0,t.jsx)(f.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Expense"]})]})]})}function v({params:e}){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"px-4 py-8 animate-pulse",children:"Loading..."}),children:(0,t.jsx)(g,{params:e})})}e.s(["default",()=>v],36984)}]);