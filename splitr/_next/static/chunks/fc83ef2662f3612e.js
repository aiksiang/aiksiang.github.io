(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46760,e=>{"use strict";function t(e,a,n={}){let s=e.currency??a;if(s===a)return e.amount;let r=n[s]??1;return e.amount*r}function a(e,n,s,r={}){let l=new Map,m=new Map;for(let e of n)l.set(e,0),m.set(e,0);for(let a of e){let e=t(a,s,r),i=a.amount>0?e/a.amount:1;for(let t of(l.set(a.paidBy,(l.get(a.paidBy)||0)+e),function(e,t){let{splitType:a,splits:n,amount:s}=e;switch(a){case"equal":{let e=n.length>0?n.map(e=>e.memberId):t,a=s/e.length;return e.map(e=>({memberId:e,amount:a}))}case"exact":return n;case"percentage":return n.map(e=>({memberId:e.memberId,amount:e.amount/100*s}));case"shares":{let e=n.reduce((e,t)=>e+t.amount,0);if(0===e)return[];return n.map(t=>({memberId:t.memberId,amount:t.amount/e*s}))}}}(a,n))){let e=t.amount*i;m.set(t.memberId,(m.get(t.memberId)||0)+e)}}return n.map(e=>{let t=l.get(e)||0,a=m.get(e)||0;return{memberId:e,paid:t,owes:a,net:t-a}})}function n(e,a,s={}){return e.reduce((e,n)=>e+t(n,a,s),0)}function s(e){let t=[],a=[];for(let n of e)n.net<-.01?t.push({id:n.memberId,amount:-n.net}):n.net>.01&&a.push({id:n.memberId,amount:n.net});t.sort((e,t)=>t.amount-e.amount),a.sort((e,t)=>t.amount-e.amount);let n=[],s=0,r=0;for(;s<t.length&&r<a.length;){let e=Math.min(t[s].amount,a[r].amount);e>.01&&n.push({from:t[s].id,to:a[r].id,amount:Math.round(100*e)/100}),t[s].amount-=e,a[r].amount-=e,t[s].amount<.01&&s++,a[r].amount<.01&&r++}return n}e.s(["calculateBalances",()=>a,"simplifyDebts",()=>s,"totalSpentInBase",()=>n])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},1215,e=>{"use strict";var t=e.i(43476),a=e.i(71645),n=e.i(18566),s=e.i(46932),r=e.i(41447),l=e.i(46760),m=e.i(85149),i=e.i(97857);let o=(0,e.i(75254).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var c=e.i(43531);function d({settlements:e,members:a,currency:n}){let r=new Map(a.map(e=>[e.id,e]));return 0===e.length?(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center py-12",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center h-16 w-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 mb-4",children:(0,t.jsx)(c.Check,{className:"h-8 w-8 text-emerald-600 dark:text-emerald-400"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-1",children:"All settled up!"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No outstanding balances between anyone."})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mb-4",children:[e.length," payment",1!==e.length?"s":""," to settle all debts"]}),e.map((e,a)=>{let l=r.get(e.from),c=r.get(e.to);return l&&c?(0,t.jsxs)(s.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"flex items-center gap-3 p-4 rounded-2xl bg-card border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,t.jsx)(i.MemberAvatar,{name:l.name,color:l.color,size:"md"}),(0,t.jsx)("span",{className:"text-sm font-medium truncate",children:l.name})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center shrink-0 px-2",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-primary tabular-nums",children:(0,m.formatAmount)(e.amount,n)}),(0,t.jsx)(o,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0 justify-end",children:[(0,t.jsx)("span",{className:"text-sm font-medium truncate",children:c.name}),(0,t.jsx)(i.MemberAvatar,{name:c.name,color:c.color,size:"md"})]})]},a):null})]})}var u=e.i(19455),x=e.i(71689);function h({params:e}){let{id:m}=(0,a.use)(e),{getTrip:i}=(0,r.useStore)(),o=(0,n.useRouter)(),c=i(m);if(!c)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-dvh p-4",children:[(0,t.jsx)("p",{className:"text-4xl mb-4",children:"ðŸ”"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Trip not found"}),(0,t.jsx)(u.Button,{variant:"outline",onClick:()=>o.push("/"),children:"Go home"})]});let h=c.members.map(e=>e.id),p=c.exchangeRates??{},f=(0,l.calculateBalances)(c.expenses,h,c.currency,p),b=(0,l.simplifyDebts)(f);return(0,t.jsxs)("div",{className:"px-4 pb-8",children:[(0,t.jsxs)(s.motion.header,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-3 pt-6 pb-4",children:[(0,t.jsx)(u.Button,{variant:"ghost",size:"icon",className:"rounded-full shrink-0",onClick:()=>o.back(),children:(0,t.jsx)(x.ArrowLeft,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Settle Up"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[c.emoji," ",c.name]})]})]}),(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"mt-4",children:(0,t.jsx)(d,{settlements:b,members:c.members,currency:c.currency})})]})}e.s(["default",()=>h],1215)}]);